<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <meta name="viewport" content="width=device-width,
                                   initial-scale=1.0,
                                   user-scalable=yes">
    <meta name="author" content="Daniel Jour">
            <meta name="dcterms.date" content="2018-01-10">
                <title>Project-relative links with Pandoc â€“ musteresel's blog</title>
    <style type="text/css">code{white-space: pre;}</style>
        <style type="text/css">
      body {
      padding-left: 1em;
      padding-right: 1em;
      margin-left: auto;
      margin-right: auto;
      max-width: 42em;
      font-size: 100%;
      font-family: Verdana, Geneva, sans-serif;
      line-height: 24px;
      }
      div.sourceCode {
      line-height: normal;
      }
      .heading {
      color: #002560;
      }
      a:link, a:visited {
      color: #008aa3;
      text-decoration: none;
      }
      a:hover {
      color: #004d60;
      text-decoration: none;
      }
      a:active {
      color: white;
      background-color: #008aa3;
      }
      footer {
      font-size: 75%;
      }
      .not-my-info {
      font-size: 0;
      }
      pre > code {
      overflow-x: auto;
      display: block;
      }
    </style>
        <style type="text/css">
      div.sourceCode { overflow-x: auto; }
      table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
        margin: 0; padding: 0; vertical-align: baseline; border: none; }
      table.sourceCode { width: 100%; line-height: 100%; }
      td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
      td.sourceCode { padding-left: 5px; }
      code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code > span.dt { color: #902000; } /* DataType */
      code > span.dv { color: #40a070; } /* DecVal */
      code > span.bn { color: #40a070; } /* BaseN */
      code > span.fl { color: #40a070; } /* Float */
      code > span.ch { color: #4070a0; } /* Char */
      code > span.st { color: #4070a0; } /* String */
      code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code > span.ot { color: #007020; } /* Other */
      code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code > span.fu { color: #06287e; } /* Function */
      code > span.er { color: #ff0000; font-weight: bold; } /* Error */
      code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
      code > span.cn { color: #880000; } /* Constant */
      code > span.sc { color: #4070a0; } /* SpecialChar */
      code > span.vs { color: #4070a0; } /* VerbatimString */
      code > span.ss { color: #bb6688; } /* SpecialString */
      code > span.im { } /* Import */
      code > span.va { color: #19177c; } /* Variable */
      code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code > span.op { color: #666666; } /* Operator */
      code > span.bu { } /* BuiltIn */
      code > span.ex { } /* Extension */
      code > span.pp { color: #bc7a00; } /* Preprocessor */
      code > span.at { color: #7d9029; } /* Attribute */
      code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    </style>
            <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <header>
      <h1 class="heading"><a href="../../../index.html">musteresel's blog</a></h1>
    </header>
    <hr>
    <article>
            <header>
        <h1 class="title">Project-relative links with Pandoc</h1>
                                <p class="date">2018-01-10</p>
                        <p class="tags">tagged:
                    <a href="../../../posts/tagged/blog/index.html">blog</a>,
                    <a href="../../../posts/tagged/web/index.html">web</a></p>
              </header>
            <p>I don't want to write something like <code>../../../posts/foo/bar.html</code> when linking from one blog post to another. A link like that would need to be changed when either the target (<code>bar.html</code>) or the starting post moved to another location.</p>
<p>IMO it's far more convenient to just write <code>posts/foo/bar.html</code>. This URL should be interpreted as relative with regard to the root directory of the blog / project.</p>
<p>Initially I abused the HTML <code>&lt;base&gt;</code> tag for this. Adding</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;base</span><span class="ot"> href=</span><span class="st">&quot;../../../&quot;</span><span class="kw">&gt;</span></code></pre></div>
<p>to the head of a HTML page makes the browser prefix relative links like the above <code>posts/foo/bar.html</code> with the URL given in the <code>href</code> attribute (<code>../../../</code> in this case).</p>
<p>This worked out pretty well at first. Or, at least until I needed a <em>real</em> relative link (as in relative to the current page). This is especially annoying because this</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;#section&quot;</span><span class="kw">&gt;</span>Go to some section<span class="kw">&lt;/a&gt;</span></code></pre></div>
<p>is <em>also</em> a relative link. So with the above <code>&lt;base&gt;</code> tag, that link points to <code>../../../#section</code>.</p>
<p><strong>This is extremely inconvenient!</strong> Thus I wrote a filter for Pandoc to turn absolute URLs (file paths, rather) into links relative to the project root. It leaves relative links like <code>appendix/data.txt</code> or <code>#section</code> unchanged and rather turns absolute file paths (<code>/posts/foo/bar.html</code>) into links relative to the project root by prefixing them with a given <code>pathToProjectRoot</code>.</p>
<p>You can find the <a href="https://github.com/musteresel/pandoc-project-relative-links">filter on Github</a>. It's written in Haskell. Contributions are welcome!</p>
<p>Running</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">pandoc</span> -t markdown -i in.md \
  --filter pandoc-project-relative-links \
  -M pathToProjectRoot=../../..</code></pre></div>
<p>turns an <code>in.md</code> like</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">This is a <span class="ot">[relative link](relative/link.html)</span> and this a [project
relative link](/project/relative.html).  <span class="ot">[This](#thing)</span> is also
relative.</code></pre></div>
<p>into</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">This is a <span class="ot">[relative link](relative/link.html)</span> and this a [project
relative link](../../../project/relative.html). <span class="ot">[This](#thing)</span> is also
relative.</code></pre></div>
<p>The meta variable <code>pathToProjectRoot</code> can also be specified in the yaml front matter or any yaml files, of course. And even if you don't use Pandoc to create your webpages, you still can make use the filter, because Pandoc can also &quot;convert&quot; HTML to HTML.</p>
            <hr>
      <footer>
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSfV7TfT4OIcpopar3hBoLnzHBmbOi85ysjX23cQsvKzBCy4Dw/viewform?usp=pp_url&entry.1949939362=posts/2018/01/pandoc-project-relative-links.html">
          Send me a message regarding this post</a>
      </footer>
      
    </article>
    <hr>
    <footer>
      <a href="../../../legal.html">Legal Notice / Impressum</a>
    </footer>
  </body>
</html>
